<span class="title"><img style="max-height: 50px;" src="https://raw.githubusercontent.com/Roll20/roll20-character-sheets/master/Runecairn/runecairn_roll20_logo.png"></span>
    <div class="stats-column-wide">        
		<div class="flex-container">
            <div class="stat-title ability-title" data-i18n="name-u"></div>
            <div class="stat-inputs-name flex-container">
                <input class="stat-input-name" type="text" name="attr_name" />
            </div>
		<div class="horizontal-separator"></div>
            <div class="stat-title ability-title" data-i18n="vigour-u"></div>
            <div class="stat-inputs-30 flex-container">
                <input class="stat-input" type="text" name="attr_vigour" />
            </div>
		<div class="horizontal-separator"></div>
            <div class="stat-title ability-title" data-i18n="speed-u"></div>
            <div class="stat-inputs-30 flex-container">
                <input class="stat-input" type="text" name="attr_speed" />
            </div>					
		<div class="horizontal-separator"></div>
            <div class="stat-title ability-title" data-i18n="souls-u"></div>
            <div class="stat-inputs-45 flex-container">
                <input class="stat-input-45" type="text" name="attr_souls" />
            </div>
        </div>
		<div class="vertical-separator"></div>
<div class="flex-container">	
    <div class="stats-column">
        <div class="flex-container">
            <div class="stat-title ability-title-170" data-i18n="base-hit-points-u"></div>
            <div class="stat-inputs-30 flex-container">
				<input class="stat-input list-input-souls" type="text" name="attr_base_hp"  />
            </div>
        </div>		
		<div class="vertical-separator"></div>		
        <div class="flex-container">
            <div class="stat-title ability-title-130" data-i18n="hit-points-u"></div>
            <div class="stat-inputs flex-container">
                <input class="stat-input" type="text" name="attr_ability_hit_points" />
                <div class="stat-input-separator"></div>
                <input class="stat-input" type="text" name="attr_total_hp" readonly />
            </div>
        </div>
		<div class="vertical-separator"></div>
        <div class="flex-container">
            <div class="stat-title ability-title-170" data-i18n="defence-u"></div>
            <div class="stat-inputs-30 flex-container">
				<input class="stat-input list-input-souls" type="text" name="attr_ability_defence" readonly />
            </div>
        </div>		
        <div class="vertical-separator"></div>
        <div class="flex-container">
            <button class="custom-roll-button" type="roll"
                value="&{template:test-under} {{rollname=Save - Strength}} {{result=[[1d20]]}} {{target=[[@{ability_strength}]]}}"
                name="roll_strength"></button>
            <div class="horizontal-separator"></div>
            <div class="stat-title ability-title" data-i18n="strength-u"></div>
            <div class="stat-inputs flex-container">
                <input class="stat-input" type="text" name="attr_ability_strength" />
                <div class="stat-input-separator"></div>
                <input class="stat-input" type="text" name="attr_ability_strength_max" />
            </div>
        </div>
        <div class="vertical-separator"></div>
        <div class="flex-container">
            <button class="custom-roll-button" type="roll"
                value="&{template:test-under} {{rollname=Save - Dexterity}} {{result=[[1d20]]}} {{target=[[@{ability_dexterity}]]}}"
                name="roll_dexterity"></button>
            <div class="horizontal-separator"></div>
            <div class="stat-title ability-title" data-i18n="dexterity-u"></div>
            <div class="stat-inputs flex-container">
                <input class="stat-input" type="text" name="attr_ability_dexterity" />
                <div class="stat-input-separator"></div>
                <input class="stat-input" type="text" name="attr_ability_dexterity_max" />
            </div>
        </div>
        <div class="vertical-separator"></div>
        <div class="flex-container">
            <button class="custom-roll-button" type="roll"
                value="&{template:test-under} {{rollname=Save - Wits}} {{result=[[1d20]]}} {{target=[[@{ability_wits}]]}}"
                name="roll_wits"></button>
            <div class="horizontal-separator"></div>
            <div class="stat-title ability-title" data-i18n="wits-u"></div>
            <div class="stat-inputs flex-container">
                <input class="stat-input" type="text" name="attr_ability_wits" />
                <div class="stat-input-separator"></div>
                <input class="stat-input" type="text" name="attr_ability_wits_max" />
            </div>
        </div>
        <div class="vertical-separator"></div>
        <div class="flex-container">
            <button class="custom-roll-button" type="roll"
                value="&{template:test-under} {{rollname=Save - Spirit}} {{result=[[1d20]]}} {{target=[[@{ability_spirit}]]}}"
                name="roll_spirit"></button>
            <div class="horizontal-separator"></div>
            <div class="stat-title ability-title" data-i18n="spirit-u"></div>
            <div class="stat-inputs flex-container">
                <input class="stat-input" type="text" name="attr_ability_spirit" />
                <div class="stat-input-separator"></div>
                <input class="stat-input" type="text" name="attr_ability_spirit_max" />
            </div>
        </div>
		<div class="vertical-separator"></div>		
        <div class="flex-container">
            <div class="stat-title ability-title-130" data-i18n="inventory-u"></div>
            <div class="stat-inputs flex-container">
                <input class="stat-input" type="text" name="attr_current_inventory" value="( @{key_item_bulk_1} + @{key_item_bulk_2} + @{weapon1_bulk_1} + @{weapon1_bulk_2} + @{weapon2_bulk_1} + @{weapon2_bulk_2} +  @{armour1_bulk_1} + @{armour1_bulk_2} + @{armour2_bulk_1} + @{armour2_bulk_2} + @{armour3_bulk_1} + @{armour3_bulk_2} + @{item1_bulk_1} + @{item1_bulk_2} + @{item2_bulk_1} + @{item2_bulk_2} + @{item3_bulk_1} + @{item3_bulk_2} + @{item4_bulk_1} + @{item4_bulk_2} + @{item5_bulk_1} + @{item5_bulk_2} + @{item6_bulk_1} + @{item6_bulk_2} + @{item7_bulk_1} + @{item7_bulk_2} + @{item8_bulk_1} + @{item8_bulk_2} + @{item9_bulk_1} + @{item9_bulk_2} + @{item10_bulk_1} + @{item10_bulk_2} + @{fatigue_bulk_1} + @{fatigue_bulk_2} + @{fatigue_bulk_3} + @{fatigue_bulk_4} + @{fatigue_bulk_5} + @{fatigue_bulk_6} + @{fatigue_bulk_7} + @{fatigue_bulk_8} + @{fatigue_bulk_9} + @{fatigue_bulk_10} )" disabled readonly />
				<div class="stat-input-separator"></div>
                <input class="stat-input" type="text" name="attr_ability_inventory_max" />
            </div>
        </div>
		<div class="vertical-separator"></div>
        <div class="list-title">
            <div class="grid-100-percent" data-i18n="fatigue-u"></div>		
        </div>
			<div class="stat-inputs-block list-input-center-aligned">
				<div class="vertical-separator"></div>			
				<input type="checkbox" class="grid-10-percent" name="attr_fatigue_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_fatigue_bulk_2" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_fatigue_bulk_3" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_fatigue_bulk_4" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_fatigue_bulk_5" value="1">
				<div class="vertical-separator"></div>			
				<input type="checkbox" class="grid-10-percent" name="attr_fatigue_bulk_6" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_fatigue_bulk_7" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_fatigue_bulk_8" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_fatigue_bulk_9" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_fatigue_bulk_10" value="1">
				<div class="vertical-separator"></div>
			</div>
		<div class="vertical-separator"></div>
        <div class="list-title">
            <div class="grid-100-percent" data-i18n="mead-u"></div>		
        </div>
			<div class="stat-inputs-block list-input-center-aligned">
				<div class="vertical-separator"></div>			
				<input type="checkbox" class="grid-10-percent" name="attr_mead_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_mead_2" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_mead_3" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_mead_4" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_mead_5" value="1">
				<div class="vertical-separator"></div>
			</div>
		<div class="vertical-separator"></div>
        <div class="list-title">
            <div class="grid-100-percent" data-i18n="status-u"></div>		
        </div>
		<div class="stat-inputs-block flex-container checkbox-fix">	
			<div class="vertical-separator"></div>		
			<div class="stat-title-inverted grid-30-percent" data-i18n="deprived-u"></div>		
			<input type="checkbox" class="grid-10-percent" name="attr_deprived" value="1">	
			<div class="stat-title-inverted grid-30-percent" data-i18n="cursed-u"></div>	
			<input type="checkbox" class="grid-10-percent" name="attr_cursed" value="1">
		</div>
    </div>
    <div class="horizontal-separator"></div>
    <div class="stats-wide">
        <!-- Weapons -->
        <div class="list-title">
            <div class="grid-60-percent" data-i18n="weapon-u"></div>
            <div class="grid-20-percent" data-i18n="damage-u"></div>
            <div class="grid-20-percent" data-i18n="slots-u"></div>	
        </div>
		<div class="vertical-separator"></div>
			<div class="flex-container">
				<button class="custom-roll-button" type="roll"
                value="&{template:test-damage} {{rollname=@{name}: Damage - @{weapon1}}} {{result=[[@{weapon_dmg1}]]}}"
                name="roll_weapon1"></button>
				<div class="horizontal-separator"></div>
				<div class="list-row">
					<input type="text" class="list-input grid-60-percent" name="attr_weapon1" />
					<input type="text" class="list-input-inline list-input-center-aligned grid-20-percent"
					 name="attr_weapon_dmg1" />
					<input type="checkbox" class="grid-10-percent" name="attr_weapon1_bulk_1" value="1">
					<input type="checkbox" class="grid-10-percent" name="attr_weapon1_bulk_2" value="1">
				 </div>
			</div>
		<div class="vertical-separator"></div>
			<div class="flex-container">		
				<button class="custom-roll-button" type="roll"
                value="&{template:test-damage} {{rollname=@{name}: Damage - @{weapon2}}} {{result=[[@{weapon_dmg2}]]}}"
                name="roll_weapon3"></button>
				<div class="horizontal-separator"></div>
				<div class="list-row">
                <input type="text" class="list-input grid-60-percent" name="attr_weapon2" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-20-percent"
                    name="attr_weapon_dmg2" />
				<input type="checkbox" class="grid-10-percent"  name="attr_weapon2_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent"  name="attr_weapon2_bulk_2" value="1">
				</div>
			</div>
		<div class="vertical-separator"></div>	
        <!-- Armour -->
        <div class="list-title">
            <div class="grid-70-percent" data-i18n="armour-u"></div>
            <div class="grid-10-percent">
                <div data-i18n="armour-bonus-u"></div>
            </div>
        </div>		
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_armour1" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_armour_bonus1" />
				<input type="checkbox" class="grid-10-percent" name="attr_armour1_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_armour1_bulk_2" value="1">				
            </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_armour2" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_armour_bonus2" />
				<input type="checkbox" class="grid-10-percent" name="attr_armour2_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_armour2_bulk_2" value="1">				
            </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_armour3" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_armour_bonus3"  />
				<input type="checkbox" class="grid-10-percent" name="attr_armour3_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_armour3_bulk_2" value="1">				
            </div>		
		<div class="vertical-separator"></div>			
		<!-- Items 1 -->
        <div class="list-title">
            <div class="grid-70-percent" data-i18n="item-u"></div>
            <div class="grid-10-percent">
                <div data-i18n="quantity-u"></div>
            </div>
        </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_item1" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_item_qty1" />
				<input type="checkbox" class="grid-10-percent" name="attr_item1_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_item1_bulk_2" value="1">				
            </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_item2" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_item_qty2" />
				<input type="checkbox" class="grid-10-percent" name="attr_item2_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_item2_bulk_2" value="1">				
            </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_item3" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_item_qty3" />
				<input type="checkbox" class="grid-10-percent" name="attr_item3_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_item3_bulk_2" value="1">				
            </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_item4" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_item_qty4" />
				<input type="checkbox" class="grid-10-percent" name="attr_item4_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_item4_bulk_2" value="1">				
            </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_item5" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_item_qty5" />
				<input type="checkbox" class="grid-10-percent" name="attr_item5_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_item5_bulk_2" value="1">				
            </div>
		        <!-- Notes -->
		<div class="vertical-separator"></div>        
		<div class="list-title">
            <div class="grid-100-percent" data-i18n="notes-u"></div>
        </div>
        <fieldset class="repeating_arcanas">		
            <div class="list-textarea-row">
                <textarea class="list-textarea grid-100-percent" name="attr_notes" rows="2"></textarea>
            </div>
		</fieldset>				
    </div>
    <div class="horizontal-separator"></div>
    <div class="stats-wide">
        <!-- Key Items -->
        <div class="list-title">
            <div class="grid-80-percent" data-i18n="key-item-u"></div>
            <div class="grid-10-percent">
                <div class="list-input-right-aligned" data-i18n="slots-u"></div>
            </div>			
        </div>	
		<div class="vertical-separator"></div>	
				<div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_key_item" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_key_item_hp"  />				
				<input type="checkbox" class="grid-10-percent" name="attr_key_item_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_key_item_bulk_2" value="1">				
				 </div>
		<div class="vertical-separator"></div>			
        <!-- Skills/Spells -->
        <div class="list-title">
            <div class="grid-70-percent" data-i18n="skills-spells-u"></div>
            <div class="grid-10-percent">
                <div data-i18n="damage-u"></div>
            </div>
            <div class="grid-10-percent">
                <div data-i18n="fatigue-u"></div>
            </div>			
        </div>
		<div class="vertical-separator"></div>
		<div class="flex-container">
				<button class="custom-roll-button" type="roll"
                value="&{template:test-damage} {{rollname=@{name}: @{skill1}}} {{result=[[@{skill_dmg1}]]}}"
                name="roll_skill1"></button>
				<div class="horizontal-separator"></div>
				<div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_skill1" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-20-percent"
                 name="attr_skill_dmg1" />
				<input type="checkbox" class="grid-10-percent" name="attr_skill1_fatigue" value="1">				 
				 </div>
        </div>
		<div class="vertical-separator"></div>
		<div class="flex-container">
				<button class="custom-roll-button" type="roll"
                value="&{template:test-damage} {{rollname=@{name}: @{skill2}}} {{result=[[@{skill_dmg2}]]}}"
                name="roll_skill2"></button>
				<div class="horizontal-separator"></div>
				<div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_skill2" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-20-percent"
                 name="attr_skill_dmg2" />
				<input type="checkbox" class="grid-10-percent" name="attr_skill2_fatigue" value="1">				 
				 </div>
        </div>
		<div class="vertical-separator"></div>
		<div class="flex-container">
				<button class="custom-roll-button" type="roll"
                value="&{template:test-damage} {{rollname=@{name}: @{skill3}}} {{result=[[@{skill_dmg3}]]}}"
                name="roll_skill3"></button>
				<div class="horizontal-separator"></div>
				<div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_skill3" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-20-percent"
                 name="attr_skill_dmg3" />
				<input type="checkbox" class="grid-10-percent" name="attr_skill3_fatigue" value="1">				 
				 </div>				 
        </div>
        <div class="vertical-separator"></div>		
		<div class="flex-container">
				<button class="custom-roll-button" type="roll"
                value="&{template:test-damage} {{rollname=@{name}: @{skill4}}} {{result=[[@{skill_dmg4}]]}}"
                name="roll_skill4"></button>
				<div class="horizontal-separator"></div>
				<div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_skill4" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-20-percent"
                 name="attr_skill_dmg4" />
				<input type="checkbox" class="grid-10-percent" name="attr_skill4_fatigue" value="1">				 
				 </div>				 
        </div>
        <div class="vertical-separator"></div>			
		<!-- Items 2 -->
        <div class="list-title">
            <div class="grid-70-percent" data-i18n="item-u"></div>
            <div class="grid-10-percent">
                <div data-i18n="quantity-u"></div>
            </div>
        </div>			
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_item6" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_item_qty6" />
				<input type="checkbox" class="grid-10-percent" name="attr_item6_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_item6_bulk_2" value="1">				
            </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_item7" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_item_qty7" />
				<input type="checkbox" class="grid-10-percent" name="attr_item7_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_item7_bulk_2" value="1">				
            </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_item8" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_item_qty8" />
				<input type="checkbox" class="grid-10-percent" name="attr_item8_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_item8_bulk_2" value="1">				
            </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_item9" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_item_qty9" />
				<input type="checkbox" class="grid-10-percent" name="attr_item9_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_item9_bulk_2" value="1">				
            </div>
		<div class="vertical-separator"></div>
            <div class="list-row">
                <input type="text" class="list-input grid-70-percent" name="attr_item10" />
                <input type="text" class="list-input-inline list-input-center-aligned grid-10-percent" name="attr_item_qty10" />
				<input type="checkbox" class="grid-10-percent" name="attr_item10_bulk_1" value="1">
				<input type="checkbox" class="grid-10-percent" name="attr_item10_bulk_2" value="1">				
            </div>			
    </div>
</div>

<rolltemplate class="sheet-rolltemplate-test-under">
    <div class="sheet-template-container">
        <div class="sheet-template-header">{{rollname}}</div>
        <div class="sheet-template-result">
            <span>{{result}}</span>
            {{#^rollGreater() result target}}<span>≤</span>{{/^rollGreater() result target}}
            {{#rollGreater() result target}}<span>≤</span>{{/rollGreater() result target}}
            <span>{{target}}</span>
        </div>
        {{#^rollGreater() result target}}<div class="sheet-template-outcome-success">Success</div>
        {{/^rollGreater() result target}}
        {{#rollGreater() result target}}<div class="sheet-template-outcome-failure">Failure</div>
        {{/rollGreater() result target}}
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-test-damage">
    <div class="sheet-template-container">
        <div class="sheet-template-header">{{rollname}}</div>
        <div class="sheet-template-result">
            <span>{{result}}</span>
            {{#^rollGreater() result target}}<span>≤</span>{{/^rollGreater() result target}}
            {{#rollGreater() result target}}<span>≤</span>{{/rollGreater() result target}}
            <span>{{target}}</span>
        </div>
        {{#^rollGreater() result target}}<div class="sheet-template-outcome-failure">Failure</div>
        {{/^rollGreater() result target}}
        {{#rollGreater() result target}}<div class="sheet-template-outcome-success">Success</div>
        {{/rollGreater() result target}}
    </div>
</rolltemplate>

<script type="text/worker">
on("sheet:opened change:armour_bonus1 change:armour_bonus2 change:armour_bonus3", function() {
    getAttrs(["ARMOUR_BONUS1", "ARMOUR_BONUS2", "ARMOUR_BONUS3"], function(values) {
		let armour_bonus1 = parseInt(values.ARMOUR_BONUS1)||0;
		let armour_bonus2 = parseInt(values.ARMOUR_BONUS2)||0;
		let armour_bonus3 = parseInt(values.ARMOUR_BONUS3)||0;
		let def = armour_bonus1 + armour_bonus2 + armour_bonus3;
        setAttrs({
            ability_defence: def
        });
    });
});
</script>

<script type="text/worker">
on("sheet:opened change:key_item_hp change:base_hp change:vigour", function() {
    getAttrs(["KEY_ITEM_HP", "BASE_HP", "VIGOUR"], function(values) {
		let key_item_hp = parseInt(values.KEY_ITEM_HP)||0;
		let base_hp = parseInt(values.BASE_HP)||0;
		let vigour = parseInt(values.VIGOUR)||0;
		let thp = key_item_hp + base_hp + vigour;
        setAttrs({
            total_hp: thp
        });
    });
});
</script>